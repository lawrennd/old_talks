<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="dcterms.date" content="2015-10-13">
  <title>Linear Algebra and Linear Regression</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="reveal.js/css/reveal.css">
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <link rel="stylesheet" href="reveal.js/css/theme/black.css" id="theme">
  <link rel="stylesheet" href="talks.css"/>
  <!-- Printing and PDF exports -->
  <script>
    var link = document.createElement( 'link' );
    link.rel = 'stylesheet';
    link.type = 'text/css';
    link.href = window.location.search.match( /print-pdf/gi ) ? 'reveal.js/css/print/pdf.css' : 'reveal.js/css/print/paper.css';
    document.getElementsByTagName( 'head' )[0].appendChild( link );
  </script>
  <!--[if lt IE 9]>
  <script src="reveal.js/lib/js/html5shiv.js"></script>
  <![endif]-->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG" type="text/javascript"></script>
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
    TeX: {
         extensions: ["color.js"]
      }
    });
  </script>
  <script src="figure-animate.js"></script>
</head>
<body>
\[\newcommand{\tk}[1]{}
%\newcommand{\tk}[1]{\textbf{TK}: #1}
\newcommand{\Amatrix}{\mathbf{A}}
\newcommand{\KL}[2]{\text{KL}\left( #1\,\|\,#2 \right)}
\newcommand{\Kaast}{\kernelMatrix_{\mathbf{ \ast}\mathbf{ \ast}}}
\newcommand{\Kastu}{\kernelMatrix_{\mathbf{ \ast} \inducingVector}}
\newcommand{\Kff}{\kernelMatrix_{\mappingFunctionVector \mappingFunctionVector}}
\newcommand{\Kfu}{\kernelMatrix_{\mappingFunctionVector \inducingVector}}
\newcommand{\Kuast}{\kernelMatrix_{\inducingVector \bf\ast}}
\newcommand{\Kuf}{\kernelMatrix_{\inducingVector \mappingFunctionVector}}
\newcommand{\Kuu}{\kernelMatrix_{\inducingVector \inducingVector}}
\newcommand{\Kuui}{\Kuu^{-1}}
\newcommand{\Qaast}{\mathbf{Q}_{\bf \ast \ast}}
\newcommand{\Qastf}{\mathbf{Q}_{\ast \mappingFunction}}
\newcommand{\Qfast}{\mathbf{Q}_{\mappingFunctionVector \bf \ast}}
\newcommand{\Qff}{\mathbf{Q}_{\mappingFunctionVector \mappingFunctionVector}}
\newcommand{\aMatrix}{\mathbf{A}}
\newcommand{\aScalar}{a}
\newcommand{\aVector}{\mathbf{a}}
\newcommand{\acceleration}{a}
\newcommand{\bMatrix}{\mathbf{B}}
\newcommand{\bScalar}{b}
\newcommand{\bVector}{\mathbf{b}}
\newcommand{\basisFunc}{\phi}
\newcommand{\basisFuncVector}{\boldsymbol{ \basisFunc}}
\newcommand{\basisFunction}{\phi}
\newcommand{\basisLocation}{\mu}
\newcommand{\basisMatrix}{\boldsymbol{ \Phi}}
\newcommand{\basisScalar}{\basisFunction}
\newcommand{\basisVector}{\boldsymbol{ \basisFunction}}
\newcommand{\activationFunction}{\phi}
\newcommand{\activationMatrix}{\boldsymbol{ \Phi}}
\newcommand{\activationScalar}{\basisFunction}
\newcommand{\activationVector}{\boldsymbol{ \basisFunction}}
\newcommand{\bigO}{\mathcal{O}}
\newcommand{\binomProb}{\pi}
\newcommand{\cMatrix}{\mathbf{C}}
\newcommand{\cbasisMatrix}{\hat{\boldsymbol{ \Phi}}}
\newcommand{\cdataMatrix}{\hat{\dataMatrix}}
\newcommand{\cdataScalar}{\hat{\dataScalar}}
\newcommand{\cdataVector}{\hat{\dataVector}}
\newcommand{\centeredKernelMatrix}{\mathbf{ \MakeUppercase{\centeredKernelScalar}}}
\newcommand{\centeredKernelScalar}{b}
\newcommand{\centeredKernelVector}{\centeredKernelScalar}
\newcommand{\centeringMatrix}{\mathbf{H}}
\newcommand{\chiSquaredDist}[2]{\chi_{#1}^{2}\left(#2\right)}
\newcommand{\chiSquaredSamp}[1]{\chi_{#1}^{2}}
\newcommand{\conditionalCovariance}{\boldsymbol{ \Sigma}}
\newcommand{\coregionalizationMatrix}{\mathbf{B}}
\newcommand{\coregionalizationScalar}{b}
\newcommand{\coregionalizationVector}{\mathbf{ \coregionalizationScalar}}
\newcommand{\covDist}[2]{\text{cov}_{#2}\left(#1\right)}
\newcommand{\covSamp}[1]{\text{cov}\left(#1\right)}
\newcommand{\covarianceScalar}{c}
\newcommand{\covarianceVector}{\mathbf{ \covarianceScalar}}
\newcommand{\covarianceMatrix}{\mathbf{C}}
\newcommand{\covarianceMatrixTwo}{\boldsymbol{ \Sigma}}
\newcommand{\croupierScalar}{s}
\newcommand{\croupierVector}{\mathbf{ \croupierScalar}}
\newcommand{\croupierMatrix}{\mathbf{ \MakeUppercase{\croupierScalar}}}
\newcommand{\dataDim}{p}
\newcommand{\dataIndex}{i}
\newcommand{\dataIndexTwo}{j}
\newcommand{\dataMatrix}{\mathbf{Y}}
\newcommand{\dataScalar}{y}
\newcommand{\dataSet}{\mathcal{D}}
\newcommand{\dataStd}{\sigma}
\newcommand{\dataVector}{\mathbf{ \dataScalar}}
\newcommand{\decayRate}{d}
\newcommand{\degreeMatrix}{\mathbf{ \MakeUppercase{\degreeScalar}}}
\newcommand{\degreeScalar}{d}
\newcommand{\degreeVector}{\mathbf{ \degreeScalar}}
% Already defined by latex
%\newcommand{\det}[1]{\left|#1\right|}
\newcommand{\diag}[1]{\text{diag}\left(#1\right)}
\newcommand{\diagonalMatrix}{\mathbf{D}}
\newcommand{\diff}[2]{\frac{\text{d}#1}{\text{d}#2}}
\newcommand{\diffTwo}[2]{\frac{\text{d}^2#1}{\text{d}#2^2}}
\newcommand{\displacement}{x}
\newcommand{\displacementVector}{\textbf{\displacement}}
\newcommand{\distanceMatrix}{\mathbf{ \MakeUppercase{\distanceScalar}}}
\newcommand{\distanceScalar}{d}
\newcommand{\distanceVector}{\mathbf{ \distanceScalar}}
\newcommand{\eigenvaltwo}{\ell}
\newcommand{\eigenvaltwoMatrix}{\mathbf{L}}
\newcommand{\eigenvaltwoVector}{\mathbf{l}}
\newcommand{\eigenvalue}{\lambda}
\newcommand{\eigenvalueMatrix}{\boldsymbol{ \Lambda}}
\newcommand{\eigenvalueVector}{\boldsymbol{ \lambda}}
\newcommand{\eigenvector}{\mathbf{ \eigenvectorScalar}}
\newcommand{\eigenvectorMatrix}{\mathbf{U}}
\newcommand{\eigenvectorScalar}{u}
\newcommand{\eigenvectwo}{\mathbf{v}}
\newcommand{\eigenvectwoMatrix}{\mathbf{V}}
\newcommand{\eigenvectwoScalar}{v}
\newcommand{\entropy}[1]{\mathcal{H}\left(#1\right)}
\newcommand{\errorFunction}{E}
\newcommand{\expDist}[2]{\left<#1\right>_{#2}}
\newcommand{\expSamp}[1]{\left<#1\right>}
\newcommand{\expectation}[1]{\left\langle #1 \right\rangle }
\newcommand{\expectationDist}[2]{\left\langle #1 \right\rangle _{#2}}
\newcommand{\expectedDistanceMatrix}{\mathcal{D}}
\newcommand{\eye}{\mathbf{I}}
\newcommand{\fantasyDim}{r}
\newcommand{\fantasyMatrix}{\mathbf{ \MakeUppercase{\fantasyScalar}}}
\newcommand{\fantasyScalar}{z}
\newcommand{\fantasyVector}{\mathbf{ \fantasyScalar}}
\newcommand{\featureStd}{\varsigma}
\newcommand{\gammaCdf}[3]{\mathcal{GAMMA CDF}\left(#1|#2,#3\right)}
\newcommand{\gammaDist}[3]{\mathcal{G}\left(#1|#2,#3\right)}
\newcommand{\gammaSamp}[2]{\mathcal{G}\left(#1,#2\right)}
\newcommand{\gaussianDist}[3]{\mathcal{N}\left(#1|#2,#3\right)}
\newcommand{\gaussianSamp}[2]{\mathcal{N}\left(#1,#2\right)}
\newcommand{\given}{|}
\newcommand{\half}{\frac{1}{2}}
\newcommand{\heaviside}{H}
\newcommand{\hiddenMatrix}{\mathbf{ \MakeUppercase{\hiddenScalar}}}
\newcommand{\hiddenScalar}{h}
\newcommand{\hiddenVector}{\mathbf{ \hiddenScalar}}
\newcommand{\identityMatrix}{\eye}
\newcommand{\inducingInputScalar}{z}
\newcommand{\inducingInputVector}{\mathbf{ \inducingInputScalar}}
\newcommand{\inducingInputMatrix}{\mathbf{Z}}
\newcommand{\inducingScalar}{u}
\newcommand{\inducingVector}{\mathbf{ \inducingScalar}}
\newcommand{\inducingMatrix}{\mathbf{U}}
\newcommand{\inlineDiff}[2]{\text{d}#1/\text{d}#2}
\newcommand{\inputDim}{q}
\newcommand{\inputMatrix}{\mathbf{X}}
\newcommand{\inputScalar}{x}
\newcommand{\inputSpace}{\mathcal{X}}
\newcommand{\inputVals}{\inputVector}
\newcommand{\inputVector}{\mathbf{ \inputScalar}}
\newcommand{\iterNum}{k}
\newcommand{\kernel}{\kernelScalar}
\newcommand{\kernelMatrix}{\mathbf{K}}
\newcommand{\kernelScalar}{k}
\newcommand{\kernelVector}{\mathbf{ \kernelScalar}}
\newcommand{\kff}{\kernelScalar_{\mappingFunction \mappingFunction}}
\newcommand{\kfu}{\kernelVector_{\mappingFunction \inducingScalar}}
\newcommand{\kuf}{\kernelVector_{\inducingScalar \mappingFunction}}
\newcommand{\kuu}{\kernelVector_{\inducingScalar \inducingScalar}}
\newcommand{\lagrangeMultiplier}{\lambda}
\newcommand{\lagrangeMultiplierMatrix}{\boldsymbol{ \Lambda}}
\newcommand{\lagrangian}{L}
\newcommand{\laplacianFactor}{\mathbf{ \MakeUppercase{\laplacianFactorScalar}}}
\newcommand{\laplacianFactorScalar}{m}
\newcommand{\laplacianFactorVector}{\mathbf{ \laplacianFactorScalar}}
\newcommand{\laplacianMatrix}{\mathbf{L}}
\newcommand{\laplacianScalar}{\ell}
\newcommand{\laplacianVector}{\mathbf{ \ell}}
\newcommand{\latentDim}{q}
\newcommand{\latentDistanceMatrix}{\boldsymbol{ \Delta}}
\newcommand{\latentDistanceScalar}{\delta}
\newcommand{\latentDistanceVector}{\boldsymbol{ \delta}}
\newcommand{\latentForce}{f}
\newcommand{\latentFunction}{u}
\newcommand{\latentFunctionVector}{\mathbf{ \latentFunction}}
\newcommand{\latentFunctionMatrix}{\mathbf{ \MakeUppercase{\latentFunction}}}
\newcommand{\latentIndex}{j}
\newcommand{\latentScalar}{z}
\newcommand{\latentVector}{\mathbf{ \latentScalar}}
\newcommand{\latentMatrix}{\mathbf{Z}}
\newcommand{\learnRate}{\eta}
\newcommand{\lengthScale}{\ell}
\newcommand{\rbfWidth}{\ell}
\newcommand{\likelihoodBound}{\mathcal{L}}
\newcommand{\likelihoodFunction}{L}
\newcommand{\locationScalar}{\mu}
\newcommand{\locationVector}{\boldsymbol{ \locationScalar}}
\newcommand{\locationMatrix}{\mathbf{M}}
\newcommand{\variance}[1]{\text{var}\left( #1 \right)}
\newcommand{\mappingFunction}{f}
\newcommand{\mappingFunctionMatrix}{\mathbf{F}}
\newcommand{\mappingFunctionTwo}{g}
\newcommand{\mappingFunctionTwoMatrix}{\mathbf{G}}
\newcommand{\mappingFunctionTwoVector}{\mathbf{ \mappingFunctionTwo}}
\newcommand{\mappingFunctionVector}{\mathbf{ \mappingFunction}}
\newcommand{\scaleScalar}{s}
\newcommand{\mappingScalar}{w}
\newcommand{\mappingVector}{\mathbf{ \mappingScalar}}
\newcommand{\mappingMatrix}{\mathbf{W}}
\newcommand{\mappingScalarTwo}{v}
\newcommand{\mappingVectorTwo}{\mathbf{ \mappingScalarTwo}}
\newcommand{\mappingMatrixTwo}{\mathbf{V}}
\newcommand{\maxIters}{K}
\newcommand{\meanMatrix}{\mathbf{M}}
\newcommand{\meanScalar}{\mu}
\newcommand{\meanTwoMatrix}{\mathbf{M}}
\newcommand{\meanTwoScalar}{m}
\newcommand{\meanTwoVector}{\mathbf{ \meanTwoScalar}}
\newcommand{\meanVector}{\boldsymbol{ \meanScalar}}
\newcommand{\mrnaConcentration}{m}
\newcommand{\naturalFrequency}{\omega}
\newcommand{\neighborhood}[1]{\mathcal{N}\left( #1 \right)}
\newcommand{\neilurl}{http://inverseprobability.com/}
\newcommand{\noiseMatrix}{\boldsymbol{ E}}
\newcommand{\noiseScalar}{\epsilon}
\newcommand{\noiseVector}{\boldsymbol{ \epsilon}}
\newcommand{\norm}[1]{\left\Vert #1 \right\Vert}
\newcommand{\normalizedLaplacianMatrix}{\hat{\mathbf{L}}}
\newcommand{\normalizedLaplacianScalar}{\hat{\ell}}
\newcommand{\normalizedLaplacianVector}{\hat{\mathbf{ \ell}}}
\newcommand{\numActive}{m}
\newcommand{\numBasisFunc}{m}
\newcommand{\numComponents}{m}
\newcommand{\numComps}{K}
\newcommand{\numData}{n}
\newcommand{\numFeatures}{K}
\newcommand{\numHidden}{h}
\newcommand{\numInducing}{m}
\newcommand{\numLayers}{\ell}
\newcommand{\numNeighbors}{K}
\newcommand{\numSequences}{s}
\newcommand{\numSuccess}{s}
\newcommand{\numTasks}{m}
\newcommand{\numTime}{T}
\newcommand{\numTrials}{S}
\newcommand{\outputIndex}{j}
\newcommand{\paramVector}{\boldsymbol{ \theta}}
\newcommand{\parameterMatrix}{\boldsymbol{ \Theta}}
\newcommand{\parameterScalar}{\theta}
\newcommand{\parameterVector}{\boldsymbol{ \parameterScalar}}
\newcommand{\partDiff}[2]{\frac{\partial#1}{\partial#2}}
\newcommand{\precisionScalar}{j}
\newcommand{\precisionVector}{\mathbf{ \precisionScalar}}
\newcommand{\precisionMatrix}{\mathbf{J}}
\newcommand{\pseudotargetScalar}{\widetilde{y}}
\newcommand{\pseudotargetVector}{\mathbf{ \pseudotargetScalar}}
\newcommand{\pseudotargetMatrix}{\mathbf{ \widetilde{Y}}}
\newcommand{\rank}[1]{\text{rank}\left(#1\right)}
\newcommand{\rayleighDist}[2]{\mathcal{R}\left(#1|#2\right)}
\newcommand{\rayleighSamp}[1]{\mathcal{R}\left(#1\right)}
\newcommand{\responsibility}{r}
\newcommand{\rotationScalar}{r}
\newcommand{\rotationVector}{\mathbf{ \rotationScalar}}
\newcommand{\rotationMatrix}{\mathbf{R}}
\newcommand{\sampleCovScalar}{s}
\newcommand{\sampleCovVector}{\mathbf{ \sampleCovScalar}}
\newcommand{\sampleCovMatrix}{\mathbf{s}}
\newcommand{\scalarProduct}[2]{\left\langle{#1},{#2}\right\rangle}
\newcommand{\sign}[1]{\text{sign}\left(#1\right)}
\newcommand{\sigmoid}[1]{\sigma\left(#1\right)}
\newcommand{\singularvalue}{\ell}
\newcommand{\singularvalueMatrix}{\mathbf{L}}
\newcommand{\singularvalueVector}{\mathbf{l}}
\newcommand{\sorth}{\mathbf{u}}
\newcommand{\spar}{\lambda}
\newcommand{\trace}[1]{\text{tr}\left(#1\right)}
\newcommand{\BasalRate}{B}
\newcommand{\DampingCoefficient}{C}
\newcommand{\DecayRate}{D}
\newcommand{\Displacement}{X}
\newcommand{\LatentForce}{F}
\newcommand{\Mass}{M}
\newcommand{\Sensitivity}{S}
\newcommand{\basalRate}{b}
\newcommand{\dampingCoefficient}{c}
\newcommand{\mass}{m}
\newcommand{\sensitivity}{s}
\newcommand{\springScalar}{\kappa}
\newcommand{\springVector}{\boldsymbol{ \kappa}}
\newcommand{\springMatrix}{\boldsymbol{ \mathcal{K}}}
\newcommand{\tfConcentration}{p}
\newcommand{\tfDecayRate}{\delta}
\newcommand{\tfMrnaConcentration}{f}
\newcommand{\tfVector}{\mathbf{ \tfConcentration}}
\newcommand{\velocity}{v}
\newcommand{\sufficientStatsScalar}{g}
\newcommand{\sufficientStatsVector}{\mathbf{ \sufficientStatsScalar}}
\newcommand{\sufficientStatsMatrix}{\mathbf{G}}
\newcommand{\switchScalar}{s}
\newcommand{\switchVector}{\mathbf{ \switchScalar}}
\newcommand{\switchMatrix}{\mathbf{S}}
\newcommand{\tr}[1]{\text{tr}\left(#1\right)}
\newcommand{\loneNorm}[1]{\left\Vert #1 \right\Vert_1}
\newcommand{\ltwoNorm}[1]{\left\Vert #1 \right\Vert_2}
\newcommand{\onenorm}[1]{\left\vert#1\right\vert_1}
\newcommand{\twonorm}[1]{\left\Vert #1 \right\Vert}
\newcommand{\vScalar}{v}
\newcommand{\vVector}{\mathbf{v}}
\newcommand{\vMatrix}{\mathbf{V}}
\newcommand{\varianceDist}[2]{\text{var}_{#2}\left( #1 \right)}
% Already defined by latex
%\newcommand{\vec}{#1:}
\newcommand{\vecb}[1]{\left(#1\right):}
\newcommand{\weightScalar}{w}
\newcommand{\weightVector}{\mathbf{ \weightScalar}}
\newcommand{\weightMatrix}{\mathbf{W}}
\newcommand{\weightedAdjacencyMatrix}{\mathbf{A}}
\newcommand{\weightedAdjacencyScalar}{a}
\newcommand{\weightedAdjacencyVector}{\mathbf{ \weightedAdjacencyScalar}}
\newcommand{\onesVector}{\mathbf{1}}
\newcommand{\zerosVector}{\mathbf{0}}
\]
  <div class="reveal">
    <div class="slides">

<section id="title-slide">
  <h1 class="title">Linear Algebra and Linear Regression</h1>
  <p class="author" style="text-align:center"><a href="http://inverseprobability.com">Neil D. Lawrence</a></p>
  <p class="date" style="text-align:center"><time>2015-10-13</time></p>
  <p class="venue" style="text-align:center">University of Sheffield</p>
</section>

<section class="slide level3">

<!-- Front matter -->
<!-- Front matter -->
<!-- Do not edit this file locally. -->
<!-- Do not edit this file locally. -->
<!-- Do not edit this file locally. -->
<!---->
<!-- Do not edit this file locally. -->
<!--Back matter-->
<!-- Do not edit this file locally. -->
<!-- The last names to be defined. Should be defined entirely in terms of macros from above-->
</section>
<section id="review" class="slide level3">
<h3>Review</h3>
<ul>
<li>Last time: Looked at objective functions for movie recommendation.</li>
<li>Minimized sum of squares objective by steepest descent and stochastic gradients.</li>
<li>This time: explore least squares for regression.</li>
</ul>
</section>
<section id="regression-examples" class="slide level3">
<h3>Regression Examples</h3>
<ul>
<li>Predict a real value, <span class="math inline">\(\dataScalar_i\)</span> given some inputs <span class="math inline">\(\inputVector_i\)</span>.</li>
<li>Predict quality of meat given spectral measurements (Tecator data).</li>
<li>Radiocarbon dating, the C14 calibration curve: predict age given quantity of C14 isotope.</li>
<li>Predict quality of different Go or Backgammon moves given expert rated training data.</li>
</ul>
</section>
<section id="olympic-100m-data" class="slide level3">
<h3>Olympic 100m Data</h3>
<ul>
<li>Gold medal times for Olympic 100 m runners since 1896. <img class="" src="../slides/diagrams/ml/100m_final_start.jpg" width="" height="auto" align="" style="background:none; border:none; box-shadow:none; display:block; margin-left:auto; margin-right:auto;vertical-align:middle">
<center>
<em>Image from Wikimedia Commons</em>
</center>
<a href="http://bit.ly/191adDC" class="uri">http://bit.ly/191adDC</a></li>
</ul>
</section>
<section id="olympic-100m-data-1" class="slide level3">
<h3>Olympic 100m Data</h3>
</section>
<section id="olympic-marathon-data" class="slide level3">
<h3>Olympic Marathon Data</h3>
<table>
<tr>
<td width="70%">
<ul>
<li>Gold medal times for Olympic Marathon since 1896.</li>
<li>Marathons before 1924 didn’t have a standardised distance.</li>
<li>Present results using pace per km.</li>
<li>In 1904 Marathon was badly organised leading to very slow times.</li>
</ul>
</td>
<td width="30%">
<div class="centered centered" style="">
<img class="" src="../slides/diagrams/Stephen_Kiprotich.jpg" width="100%" height="auto" align="center" style="background:none; border:none; box-shadow:none; display:block; margin-left:auto; margin-right:auto;vertical-align:middle">
</div>
<small>Image from Wikimedia Commons <a href="http://bit.ly/16kMKHQ" class="uri">http://bit.ly/16kMKHQ</a></small>
</td>
</tr>
</table>
</section>
<section id="olympic-marathon-data-1" class="slide level3">
<h3>Olympic Marathon Data</h3>
<div class="figure">
<div id="olympic-marathon-figure" class="figure-frame">
<object class="svgplot " data="../slides/diagrams/datasets/olympic-marathon.svg" width style=" ">
</object>
</div>
</div>
<!-- SECTION What is Machine Learning? -->
</section>
<section id="what-is-machine-learning" class="slide level3">
<h3>What is Machine Learning?</h3>
<div class="fragment">
<p><span class="math display">\[ \text{data} + \text{model} \xrightarrow{\text{compute}} \text{prediction}\]</span></p>
</div>
<div class="fragment">
<ul>
<li><strong>data</strong> : observations, could be actively or passively acquired (meta-data).</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><strong>model</strong> : assumptions, based on previous experience (other data! transfer learning etc), or beliefs about the regularities of the universe. Inductive bias.</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><strong>prediction</strong> : an action to be taken or a categorization or a quality score.</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Royal Society Report: <a href="https://royalsociety.org/~/media/policy/projects/machine-learning/publications/machine-learning-report.pdf">Machine Learning: Power and Promise of Computers that Learn by Example</a></li>
</ul>
</div>
</section>
<section id="what-is-machine-learning-1" class="slide level3">
<h3>What is Machine Learning?</h3>
<p><span class="math display">\[\text{data} + \text{model} \xrightarrow{\text{compute}} \text{prediction}\]</span></p>
<ul>
<li class="fragment">To combine data with a model need:</li>
<li class="fragment"><strong>a prediction function</strong> <span class="math inline">\(\mappingFunction (\cdot)\)</span> includes our beliefs about the regularities of the universe</li>
<li class="fragment"><strong>an objective function</strong> <span class="math inline">\(\errorFunction (\cdot)\)</span> defines the cost of misprediction.</li>
</ul>
<!-- SECTION Sum of Squares Error -->
</section>
<section id="regression-linear-releationship" class="slide level3">
<h3>Regression: Linear Releationship</h3>
<p><span class="math display">\[\dataScalar_i = m \inputScalar_i + c\]</span></p>
<ul>
<li><p><span class="math inline">\(\dataScalar_i\)</span> : winning pace.</p></li>
<li><p><span class="math inline">\(\inputScalar_i\)</span> : year of Olympics.</p></li>
<li><p><span class="math inline">\(m\)</span> : rate of improvement over time.</p></li>
<li><p><span class="math inline">\(c\)</span> : winning time at year 0.</p></li>
</ul>

</section>
<section id="overdetermined-system" class="slide level3">
<h3>Overdetermined System</h3>
</section>
<section id="section" class="slide level3">
<h3></h3>
<script>
showDivs(1, 'over_determined_system');
</script>
<p><small></small> <input id="range-over_determined_system" type="range" min="1" max="8" value="1" onchange="setDivs('over_determined_system')" oninput="setDivs('over_determined_system')"> <button onclick="plusDivs(-1, 'over_determined_system')">❮</button> <button onclick="plusDivs(1, 'over_determined_system')">❯</button></p>
<div class="over_determined_system" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/over_determined_system001.svg" width="40%" style=" ">
</object>
</div>
<div class="over_determined_system" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/over_determined_system002.svg" width="40%" style=" ">
</object>
</div>
<div class="over_determined_system" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/over_determined_system003.svg" width="40%" style=" ">
</object>
</div>
<div class="over_determined_system" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/over_determined_system004.svg" width="40%" style=" ">
</object>
</div>
<div class="over_determined_system" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/over_determined_system005.svg" width="40%" style=" ">
</object>
</div>
<div class="over_determined_system" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/over_determined_system006.svg" width="40%" style=" ">
</object>
</div>
<div class="over_determined_system" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/over_determined_system007.svg" width="40%" style=" ">
</object>
</div>
</section>
<section id="datascalar-minputscalar-c" class="slide level3">
<h3><span class="math inline">\(\dataScalar = m\inputScalar + c\)</span></h3>
<div class="fragment">
<p>point 1: <span class="math inline">\(\inputScalar = 1\)</span>, <span class="math inline">\(\dataScalar=3\)</span> <span class="math display">\[
3 = m + c
\]</span></p>
</div>
<div class="fragment">
<p>point 2: <span class="math inline">\(\inputScalar = 3\)</span>, <span class="math inline">\(\dataScalar=1\)</span> <span class="math display">\[
1 = 3m + c
\]</span></p>
</div>
<div class="fragment">
<p>point 3: <span class="math inline">\(\inputScalar = 2\)</span>, <span class="math inline">\(\dataScalar=2.5\)</span></p>
<p><span class="math display">\[2.5 = 2m + c\]</span></p>
</div>
</section>
<section id="section-1" class="slide level3">
<h3></h3>
</section>
<section id="section-2" class="slide level3">
<h3></h3>
<div class="figure">
<div id="pierre-simon-laplace-image-figure" class="figure-frame">
<div class="centered" style="">
<img class="" src="../slides/diagrams/ml/Pierre-Simon_Laplace.png" width="30%" height="auto" align="center" style="background:none; border:none; box-shadow:none; display:block; margin-left:auto; margin-right:auto;vertical-align:middle">
</div>
</div>
</div>
</section>
<section id="section-3" class="slide level3">
<h3></h3>
<iframe frameborder="0" scrolling="no" style="border:0px" src="http://books.google.co.uk/books?id=1YQPAAAAQAAJ&amp;pg=PR17-IA2&amp;output=embed" width="700" height="500">
</iframe>
</section>
<section id="section-4" class="slide level3">
<h3></h3>
<div class="figure">
<div id="laplaces-determinism-english-figure" class="figure-frame">
<div class="centered" style="">
<img class="" src="../slides/diagrams/laplacesDeterminismEnglish.png" width="60%" height="auto" align="center" style="background:none; border:none; box-shadow:none; display:block; margin-left:auto; margin-right:auto;vertical-align:middle">
</div>
</div>
</div>
</section>
<section id="section-5" class="slide level3">
<h3></h3>
<iframe frameborder="0" scrolling="no" style="border:0px" src="http://books.google.co.uk/books?id=1YQPAAAAQAAJ&amp;pg=PR17-IA4&amp;output=embed" width="700" height="500">
</iframe>
</section>
<section id="section-6" class="slide level3">
<h3></h3>
<div class="figure">
<div id="probability-relative-in-part-figure" class="figure-frame">
<div class="centered" style="">
<img class="" src="../slides/diagrams/philosophicaless00lapliala.png" width="60%" height="auto" align="center" style="background:none; border:none; box-shadow:none; display:block; margin-left:auto; margin-right:auto;vertical-align:middle">
</div>
</div>
</div>
</section>
<section id="datascalar-minputscalar-c-noisescalar" class="slide level3">
<h3><span class="math inline">\(\dataScalar = m\inputScalar + c + \noiseScalar\)</span></h3>
<div class="fragment">
<p>point 1: <span class="math inline">\(\inputScalar = 1\)</span>, <span class="math inline">\(\dataScalar=3\)</span> <span class="math display">\[
3 = m + c + \noiseScalar_1
\]</span></p>
</div>
<div class="fragment">
<p>point 2: <span class="math inline">\(\inputScalar = 3\)</span>, <span class="math inline">\(\dataScalar=1\)</span> <span class="math display">\[
1 = 3m + c + \noiseScalar_2
\]</span></p>
</div>
<div class="fragment">
<p>point 3: <span class="math inline">\(\inputScalar = 2\)</span>, <span class="math inline">\(\dataScalar=2.5\)</span> <span class="math display">\[
2.5 = 2m + c + \noiseScalar_3
\]</span></p>
</div>
</section>
<section id="a-probabilistic-process" class="slide level3">
<h3>A Probabilistic Process</h3>
<div class="fragment">
<p>Set the mean of Gaussian to be a function. <span class="math display">\[p
\left(\dataScalar_i|\inputScalar_i\right)=\frac{1}{\sqrt{2\pi\dataStd^2}}\exp \left(-\frac{\left(\dataScalar_i-\mappingFunction\left(\inputScalar_i\right)\right)^{2}}{2\dataStd^2}\right).
\]</span></p>
</div>
<div class="fragment">
<p>This gives us a ‘noisy function’.</p>
</div>
<div class="fragment">
<p>This is known as a stochastic process.</p>
</div>
</section>
<section id="the-gaussian-density" class="slide level3">
<h3>The Gaussian Density</h3>
<ul>
<li>Perhaps the most common probability density.</li>
</ul>
<div class="fragment">
<p><span class="math display">\[\begin{align}
  p(\dataScalar| \meanScalar, \dataStd^2) &amp; = \frac{1}{\sqrt{2\pi\dataStd^2}}\exp\left(-\frac{(\dataScalar - \meanScalar)^2}{2\dataStd^2}\right)\\&amp; \buildrel\triangle\over = \gaussianDist{\dataScalar}{\meanScalar}{\dataStd^2}
  \end{align}\]</span></p>
</div>
</section>
<section id="gaussian-density" class="slide level3">
<h3>Gaussian Density</h3>
<div class="figure">
<div id="gaussian-of-height-figure" class="figure-frame">
<object class="svgplot " data="../slides/diagrams/ml/gaussian_of_height.svg" width="60%" style=" ">
</object>
</div>
</div>
</section>
<section id="gaussian-density-1" class="slide level3">
<h3>Gaussian Density</h3>
<p><large><span class="math display">\[
\gaussianDist{\dataScalar}{\meanScalar}{\dataStd^2} = \frac{1}{\sqrt{2\pi\dataStd^2}} \exp\left(-\frac{(\dataScalar-\meanScalar)^2}{2\dataStd^2}\right)
\]</span></large></p>
<div class="fragment">
<center>
<span class="math inline">\(\dataStd^2\)</span> is the variance of the density and <span class="math inline">\(\meanScalar\)</span> is the mean.
</center>
</div>
</section>
<section id="two-important-gaussian-properties" class="slide level3">
<h3>Two Important Gaussian Properties</h3>
</section>
<section id="sum-of-gaussians" class="slide level3">
<h3>Sum of Gaussians</h3>
<div class="fragment">
<p><span style="text-align:left">Sum of Gaussian variables is also Gaussian.</span></p>
<p><span class="math display">\[\dataScalar_i \sim \gaussianSamp{\meanScalar_i}{\sigma_i^2}\]</span></p>
</div>
<div class="fragment">
<p><span style="text-align:left">And the sum is distributed as</span></p>
<p><span class="math display">\[\sum_{i=1}^{\numData} \dataScalar_i \sim \gaussianSamp{\sum_{i=1}^\numData \meanScalar_i}{\sum_{i=1}^\numData \sigma_i^2}\]</span></p>
</div>
<div class="fragment">
<p><small>(<em>Aside</em>: As sum increases, sum of non-Gaussian, finite variance variables is also Gaussian because of <a href="https://en.wikipedia.org/wiki/Central_limit_theorem">central limit theorem</a>.)</small></p>
</div>
</section>
<section id="scaling-a-gaussian" class="slide level3">
<h3>Scaling a Gaussian</h3>
<div class="fragment">
<p><span style="text-align:left">Scaling a Gaussian leads to a Gaussian.</span></p>
</div>
<div class="fragment">
<p><span class="math display">\[\dataScalar \sim \gaussianSamp{\meanScalar}{\sigma^2}\]</span></p>
</div>
<div class="fragment">
<p><span style="text-align:left">And the scaled variable is distributed as</span></p>
<p><span class="math display">\[\mappingScalar \dataScalar \sim \gaussianSamp{\mappingScalar\meanScalar}{\mappingScalar^2 \sigma^2}.\]</span></p>
<!-- SECTION Laplace's Idea -->
</div>
</section>
<section id="a-probabilistic-process-1" class="slide level3">
<h3>A Probabilistic Process</h3>
<p>Set the mean of Gaussian to be a function.</p>
<div class="fragment">
<p><span class="math display">\[p\left(\dataScalar_i|\inputScalar_i\right)=\frac{1}{\sqrt{2\pi\dataStd^2}}\exp\left(-\frac{\left(\dataScalar_i-f\left(\inputScalar_i\right)\right)^{2}}{2\dataStd^2}\right).\]</span></p>
</div>
<div class="fragment">
<p>This gives us a ‘noisy function’.</p>
</div>
<div class="fragment">
<p>This is known as a stochastic process.</p>
</div>
</section>
<section id="height-as-a-function-of-weight" class="slide level3">
<h3>Height as a Function of Weight</h3>
<p>In the standard Gaussian, parametized by mean and variance.</p>
<p>Make the mean a linear function of an <em>input</em>.</p>
<p>This leads to a regression model. <span class="math display">\[
\begin{align*}
  \dataScalar_i=&amp;\mappingFunction\left(\inputScalar_i\right)+\noiseScalar_i,\\
         \noiseScalar_i \sim &amp; \gaussianSamp{0}{\dataStd^2}.
  \end{align*}
\]</span></p>
<p>Assume <span class="math inline">\(\dataScalar_i\)</span> is height and <span class="math inline">\(\inputScalar_i\)</span> is weight.</p>
</section>
<section id="data-point-likelihood" class="slide level3">
<h3>Data Point Likelihood</h3>
<p>Likelihood of an individual data point <span class="math display">\[
p\left(\dataScalar_i|\inputScalar_i,m,c\right)=\frac{1}{\sqrt{2\pi \dataStd^2}}\exp\left(-\frac{\left(\dataScalar_i-m\inputScalar_i-c\right)^{2}}{2\dataStd^2}\right).
\]</span> Parameters are gradient, <span class="math inline">\(m\)</span>, offset, <span class="math inline">\(c\)</span> of the function and noise variance <span class="math inline">\(\dataStd^2\)</span>.</p>
</section>
<section id="data-set-likelihood" class="slide level3">
<h3>Data Set Likelihood</h3>
<p>If the noise, <span class="math inline">\(\epsilon_i\)</span> is sampled independently for each data point. Each data point is independent (given <span class="math inline">\(m\)</span> and <span class="math inline">\(c\)</span>). For <em>independent</em> variables: <span class="math display">\[
p(\dataVector) = \prod_{i=1}^\numData p(\dataScalar_i)
\]</span> <span class="math display">\[
p(\dataVector|\inputVector, m, c) = \prod_{i=1}^\numData p(\dataScalar_i|\inputScalar_i, m, c)
\]</span></p>
</section>
<section id="for-gaussian" class="slide level3">
<h3>For Gaussian</h3>
<p>i.i.d. assumption <span class="math display">\[
p(\dataVector|\inputVector, m, c) = \prod_{i=1}^\numData \frac{1}{\sqrt{2\pi \dataStd^2}}\exp \left(-\frac{\left(\dataScalar_i- m\inputScalar_i-c\right)^{2}}{2\dataStd^2}\right).
\]</span> <span class="math display">\[
p(\dataVector|\inputVector, m, c) = \frac{1}{\left(2\pi \dataStd^2\right)^{\frac{\numData}{2}}}\exp\left(-\frac{\sum_{i=1}^\numData\left(\dataScalar_i-m\inputScalar_i-c\right)^{2}}{2\dataStd^2}\right).
\]</span></p>
</section>
<section id="log-likelihood-function" class="slide level3">
<h3>Log Likelihood Function</h3>
<ul>
<li>Normally work with the log likelihood: <span class="math display">\[
L(m,c,\dataStd^{2})=-\frac{\numData}{2}\log 2\pi -\frac{\numData}{2}\log \dataStd^2 -\sum_{i=1}^{\numData}\frac{\left(\dataScalar_i-m\inputScalar_i-c\right)^{2}}{2\dataStd^2}.
\]</span></li>
</ul>
</section>
<section id="consistency-of-maximum-likelihood" class="slide level3">
<h3>Consistency of Maximum Likelihood</h3>
<ul>
<li>If data was really generated according to probability we specified.</li>
<li>Correct parameters will be recovered in limit as <span class="math inline">\(\numData \rightarrow \infty\)</span>.</li>
<li>This can be proven through sample based approximations (law of large numbers) of “KL divergences”.</li>
<li>Mainstay of classical statistics <span class="citation" data-cites="Wasserman:all03">(Wasserman, 2003)</span>.</li>
</ul>
</section>
<section id="probabilistic-interpretation-of-the-error-function" class="slide level3">
<h3>Probabilistic Interpretation of the Error Function</h3>
<ul>
<li>Probabilistic Interpretation for Error Function is Negative Log Likelihood.</li>
<li><em>Minimizing</em> error function is equivalent to <em>maximizing</em> log likelihood.</li>
<li>Maximizing <em>log likelihood</em> is equivalent to maximizing the <em>likelihood</em> because <span class="math inline">\(\log\)</span> is monotonic.</li>
<li>Probabilistic interpretation: Minimizing error function is equivalent to maximum likelihood with respect to parameters.</li>
</ul>
</section>
<section id="error-function" class="slide level3">
<h3>Error Function</h3>
<ul>
<li>Negative log likelihood is the error function leading to an error function <span class="math display">\[\errorFunction(m,c,\dataStd^{2})=\frac{\numData}{2}\log \dataStd^2+\frac{1}{2\dataStd^2}\sum _{i=1}^{\numData}\left(\dataScalar_i-m\inputScalar_i-c\right)^{2}.\]</span></li>
<li>Learning proceeds by minimizing this error function for the data set provided.</li>
</ul>
</section>
<section id="connection-sum-of-squares-error" class="slide level3">
<h3>Connection: Sum of Squares Error</h3>
<ul>
<li>Ignoring terms which don’t depend on <span class="math inline">\(m\)</span> and <span class="math inline">\(c\)</span> gives <span class="math display">\[\errorFunction(m, c) \propto \sum_{i=1}^\numData (\dataScalar_i - \mappingFunction(\inputScalar_i))^2\]</span> where <span class="math inline">\(\mappingFunction(\inputScalar_i) = m\inputScalar_i + c\)</span>.</li>
<li>This is known as the <em>sum of squares</em> error function.</li>
<li>Commonly used and is closely associated with the Gaussian likelihood.</li>
</ul>
</section>
<section id="reminder" class="slide level3">
<h3>Reminder</h3>
<ul>
<li>Two functions involved:
<ul>
<li><em>Prediction function</em>: <span class="math inline">\(\mappingFunction(\inputScalar_i)\)</span></li>
<li>Error, or <em>Objective function</em>: <span class="math inline">\(\errorFunction(m, c)\)</span></li>
</ul></li>
<li>Error function depends on parameters through prediction function.</li>
</ul>
</section>
<section id="mathematical-interpretation" class="slide level3">
<h3>Mathematical Interpretation</h3>
<ul>
<li>What is the mathematical interpretation?</li>
<li>There is a cost function.
<ul>
<li>It expresses mismatch between your prediction and reality. <span class="math display">\[
\errorFunction(m, c)=\sum_{i=1}^\numData \left(\dataScalar_i - m\inputScalar_i-c\right)^2
\]</span></li>
<li>This is known as the sum of squares error.</li>
</ul></li>
</ul>
<!-- SECTION Sum of Squares Error -->
<!-- SECTION Linear Algebra -->
</section>
<section id="coordinate-descent" class="slide level3">
<h3>Coordinate Descent</h3>
</section>
<section id="learning-is-optimization" class="slide level3">
<h3>Learning is Optimization</h3>
<ul>
<li>Learning is minimization of the cost function.</li>
<li>At the minima the gradient is zero.</li>
<li>Coordinate ascent, find gradient in each coordinate and set to zero. <span class="math display">\[\frac{\text{d}\errorFunction(c)}{\text{d}c} = -2\sum_{i=1}^\numData \left(\dataScalar_i- m \inputScalar_i - c \right)\]</span> <span class="math display">\[0 = -2\sum_{i=1}^\numData\left(\dataScalar_i- m\inputScalar_i - c \right)\]</span></li>
</ul>
</section>
<section id="learning-is-optimization-1" class="slide level3">
<h3>Learning is Optimization</h3>
<ul>
<li>Fixed point equations <span class="math display">\[0 = -2\sum_{i=1}^\numData \dataScalar_i +2\sum_{i=1}^\numData m \inputScalar_i +2n c\]</span> <span class="math display">\[c = \frac{\sum_{i=1}^\numData \left(\dataScalar_i - m\inputScalar_i\right)}{\numData}\]</span></li>
</ul>
</section>
<section id="learning-is-optimization-2" class="slide level3">
<h3>Learning is Optimization</h3>
<ul>
<li>Learning is minimization of the cost function.</li>
<li>At the minima the gradient is zero.</li>
<li>Coordinate ascent, find gradient in each coordinate and set to zero. <span class="math display">\[\frac{\text{d}\errorFunction(m)}{\text{d}m} = -2\sum_{i=1}^\numData \inputScalar_i\left(\dataScalar_i- m \inputScalar_i - c \right)\]</span> <span class="math display">\[0 = -2\sum_{i=1}^\numData \inputScalar_i \left(\dataScalar_i-m \inputScalar_i - c \right)\]</span></li>
</ul>
</section>
<section id="learning-is-optimization-3" class="slide level3">
<h3>Learning is Optimization</h3>
<ul>
<li>Fixed point equations <span class="math display">\[0 = -2\sum_{i=1}^\numData \inputScalar_i\dataScalar_i+2\sum_{i=1}^\numData m \inputScalar_i^2+2\sum_{i=1}^\numData c\inputScalar_i\]</span> <span class="math display">\[m  =    \frac{\sum_{i=1}^\numData \left(\dataScalar_i -c\right)\inputScalar_i}{\sum_{i=1}^\numData\inputScalar_i^2}\]</span></li>
</ul>
<p><span class="math display">\[m^* = \frac{\sum_{i=1}^\numData (\dataScalar_i - c)\inputScalar_i}{\sum_{i=1}^\numData \inputScalar_i^2}\]</span></p>
</section>
<section id="fixed-point-updates" class="slide level3">
<h3>Fixed Point Updates</h3>
<p><span style="text-align:left">Worked example.</span> <span class="math display">\[
\begin{aligned}
    c^{*}=&amp;\frac{\sum
_{i=1}^{\numData}\left(\dataScalar_i-m^{*}\inputScalar_i\right)}{\numData},\\
    m^{*}=&amp;\frac{\sum
_{i=1}^{\numData}\inputScalar_i\left(\dataScalar_i-c^{*}\right)}{\sum _{i=1}^{\numData}\inputScalar_i^{2}},\\
\left.\dataStd^2\right.^{*}=&amp;\frac{\sum
_{i=1}^{\numData}\left(\dataScalar_i-m^{*}\inputScalar_i-c^{*}\right)^{2}}{\numData}
\end{aligned}
\]</span></p>
</section>
<section id="important-concepts-not-covered" class="slide level3">
<h3>Important Concepts Not Covered</h3>
<ul>
<li>Other optimization methods:
<ul>
<li>Second order methods, conjugate gradient, quasi-Newton and Newton.</li>
</ul></li>
<li>Effective heuristics such as momentum.</li>
<li>Local vs global solutions.</li>
</ul>
</section>
<section id="reading" class="slide level3">
<h3>Reading</h3>
<ul>
<li>Section 1.1-1.2 of <span class="citation" data-cites="Rogers:book11">Rogers and Girolami (2011)</span> for fitting linear models.</li>
<li>Section 1.2.5 of <span class="citation" data-cites="Bishop:book06">Bishop (2006)</span> up to equation 1.65.</li>
</ul>
</section>
<section id="multi-dimensional-inputs" class="slide level3">
<h3>Multi-dimensional Inputs</h3>
<ul>
<li>Multivariate functions involve more than one input.</li>
<li>Height might be a function of weight and gender.</li>
<li>There could be other contributory factors.</li>
<li>Place these factors in a feature vector <span class="math inline">\(\inputVector_i\)</span>.</li>
<li>Linear function is now defined as <span class="math display">\[\mappingFunction(\inputVector_i) = \sum_{j=1}^p w_j \inputScalar_{i, j} + c\]</span></li>
</ul>
</section>
<section id="vector-notation" class="slide level3">
<h3>Vector Notation</h3>
<ul>
<li>Write in vector notation, <span class="math display">\[\mappingFunction(\inputVector_i) = \mappingVector^\top \inputVector_i + c\]</span></li>
<li>Can absorb <span class="math inline">\(c\)</span> into <span class="math inline">\(\mappingVector\)</span> by assuming extra input <span class="math inline">\(\inputScalar_0\)</span> which is always 1. <span class="math display">\[\mappingFunction(\inputVector_i) = \mappingVector^\top \inputVector_i\]</span></li>
</ul>
</section>
<section id="objective-functions-and-regression" class="slide level3">
<h3>Objective Functions and Regression</h3>
<ul>
<li>Classification: map feature to class label.</li>
<li><p>Regression: map feature to real value our <em>prediction function</em> is</p>
<p><span class="math display">\[\mappingFunction(\inputScalar_i) = m\inputScalar_i + c\]</span></p></li>
<li><p>Need an <em>algorithm</em> to fit it.</p></li>
<li><p>Least squares: minimize an error.</p></li>
</ul>
<p><span class="math display">\[\errorFunction(m, c) = \sum_{i=1}^\numData (\dataScalar_i * \mappingFunction(\inputScalar_i))^2\]</span></p>
</section>
<section id="regression" class="slide level3">
<h3>Regression</h3>
<ul>
<li>Create an artifical data set.</li>
</ul>
<p>We now need to decide on a <em>true</em> value for <span class="math inline">\(m\)</span> and a <em>true</em> value for <span class="math inline">\(c\)</span> to use for generating the data.</p>
<p>We can use these values to create our artificial data. The formula <span class="math display">\[\dataScalar_i = m\inputScalar_i + c\]</span> is translated to code as follows:</p>
</section>
<section id="plot-of-data" class="slide level3">
<h3>Plot of Data</h3>
<p>We can now plot the artifical data we’ve created.</p>
<div class="figure">
<div id="linear-regression-figure" class="figure-frame">
<object class="svgplot " data="../slides/diagrams/ml/regression.svg" width="60%" style=" ">
</object>
</div>
</div>
<p>These points lie exactly on a straight line, that’s not very realistic, let’s corrupt them with a bit of Gaussian ‘noise’.</p>
</section>
<section id="noise-corrupted-plot" class="slide level3">
<h3>Noise Corrupted Plot</h3>
<div class="figure">
<div id="linear-regression-noise-figure" class="figure-frame">
<object class="svgplot " data="../slides/diagrams/ml/regression_noise.svg" width="60%" style=" ">
</object>
</div>
</div>
</section>
<section id="contour-plot-of-error-function" class="slide level3">
<h3>Contour Plot of Error Function</h3>
<ul>
<li><p>Visualise the error function surface, create vectors of values.</p></li>
<li><p>create a grid of values to evaluate the error function in 2D.</p></li>
<li><p>compute the error function at each combination of <span class="math inline">\(c\)</span> and <span class="math inline">\(m\)</span>.</p></li>
</ul>
</section>
<section id="contour-plot-of-error" class="slide level3">
<h3>Contour Plot of Error</h3>
<ul>
<li>We can now make a contour plot.</li>
</ul>
<div class="figure">
<div id="regression-contour-figure" class="figure-frame">
<object class="svgplot " data="../slides/diagrams/ml/regression_contour.svg" width="60%" style=" ">
</object>
</div>
</div>
</section>
<section id="steepest-descent" class="slide level3">
<h3>Steepest Descent</h3>
<ul>
<li>Minimize the sum of squares error function.</li>
<li>One way of doing that is gradient descent.</li>
<li>Initialize with a guess for <span class="math inline">\(m\)</span> and <span class="math inline">\(c\)</span></li>
<li>update that guess by subtracting a portion of the gradient from the guess.</li>
<li>Like walking down a hill in the steepest direction of the hill to get to the bottom.</li>
</ul>
</section>
<section id="algorithm" class="slide level3">
<h3>Algorithm</h3>
<ul>
<li>We start with a guess for <span class="math inline">\(m\)</span> and <span class="math inline">\(c\)</span>.</li>
</ul>
</section>
<section id="offset-gradient" class="slide level3">
<h3>Offset Gradient</h3>
<ul>
<li><p>Now we need to compute the gradient of the error function, firstly with respect to <span class="math inline">\(c\)</span>,</p>
<p><span class="math display">\[\frac{\text{d}\errorFunction(m, c)}{\text{d} c} =
-2\sum_{i=1}^\numData (\dataScalar_i - m\inputScalar_i - c)\]</span></p></li>
<li><p>This is computed in python as follows</p></li>
</ul>
</section>
<section id="deriving-the-gradient" class="slide level3">
<h3>Deriving the Gradient</h3>
<p>To see how the gradient was derived, first note that the <span class="math inline">\(c\)</span> appears in every term in the sum. So we are just differentiating <span class="math inline">\((\dataScalar_i - m\inputScalar_i - c)^2\)</span> for each term in the sum. The gradient of this term with respect to <span class="math inline">\(c\)</span> is simply the gradient of the outer quadratic, multiplied by the gradient with respect to <span class="math inline">\(c\)</span> of the part inside the quadratic. The gradient of a quadratic is two times the argument of the quadratic, and the gradient of the inside linear term is just minus one. This is true for all terms in the sum, so we are left with the sum in the gradient.</p>
</section>
<section id="slope-gradient" class="slide level3">
<h3>Slope Gradient</h3>
<p>The gradient with respect tom <span class="math inline">\(m\)</span> is similar, but now the gradient of the quadratic’s argument is <span class="math inline">\(-\inputScalar_i\)</span> so the gradient with respect to <span class="math inline">\(m\)</span> is</p>
<p><span class="math display">\[\frac{\text{d}\errorFunction(m, c)}{\text{d} m} = -2\sum_{i=1}^\numData \inputScalar_i(\dataScalar_i - m\inputScalar_i -
c)\]</span></p>
<p>which can be implemented in python (numpy) as</p>
</section>
<section id="update-equations" class="slide level3">
<h3>Update Equations</h3>
<ul>
<li>Now we have gradients with respect to <span class="math inline">\(m\)</span> and <span class="math inline">\(c\)</span>.</li>
<li>Can update our inital guesses for <span class="math inline">\(m\)</span> and <span class="math inline">\(c\)</span> using the gradient.</li>
<li>We don’t want to just subtract the gradient from <span class="math inline">\(m\)</span> and <span class="math inline">\(c\)</span>,</li>
<li>We need to take a <em>small</em> step in the gradient direction.</li>
<li>Otherwise we might overshoot the minimum.</li>
<li>We want to follow the gradient to get to the minimum, the gradient changes all the time.</li>
</ul>
</section>
<section id="move-in-direction-of-gradient" class="slide level3">
<h3>Move in Direction of Gradient</h3>
<div class="figure">
<div id="regression-contour-step-1-figure" class="figure-frame">
<object class="svgplot " data="../slides/diagrams/ml/regression_contour_step001.svg" width="60%" style=" ">
</object>
</div>
</div>
</section>
<section id="update-equations-1" class="slide level3">
<h3>Update Equations</h3>
<ul>
<li><p>The step size has already been introduced, it’s again known as the learning rate and is denoted by <span class="math inline">\(\learnRate\)</span>. <span class="math display">\[
c_\text{new}\leftarrow c_{\text{old}} - \learnRate \frac{\text{d}\errorFunction(m, c)}{\text{d}c}
\]</span></p></li>
<li>gives us an update for our estimate of <span class="math inline">\(c\)</span> (which in the code we’ve been calling <code>c_star</code> to represent a common way of writing a parameter estimate, <span class="math inline">\(c^*\)</span>) and <span class="math display">\[
m_\text{new} \leftarrow m_{\text{old}} - \learnRate \frac{\text{d}\errorFunction(m, c)}{\text{d}m}
\]</span></li>
<li><p>Giving us an update for <span class="math inline">\(m\)</span>.</p></li>
</ul>
</section>
<section id="update-code" class="slide level3">
<h3>Update Code</h3>
<ul>
<li>These updates can be coded as</li>
</ul>
<!-- SECTION Iterating Updates -->
<ul>
<li>Fit model by descending gradient.</li>
</ul>
</section>
<section id="gradient-descent-algorithm" class="slide level3">
<h3>Gradient Descent Algorithm</h3>
<script>
showDivs(1, 'regression_contour_fit');
</script>
<p><small></small> <input id="range-regression_contour_fit" type="range" min="1" max="28" value="1" onchange="setDivs('regression_contour_fit')" oninput="setDivs('regression_contour_fit')"> <button onclick="plusDivs(-1, 'regression_contour_fit')">❮</button> <button onclick="plusDivs(1, 'regression_contour_fit')">❯</button></p>
<div class="regression_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_contour_fit000.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_contour_fit001.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_contour_fit002.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_contour_fit003.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_contour_fit004.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_contour_fit005.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_contour_fit006.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_contour_fit007.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_contour_fit008.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_contour_fit009.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_contour_fit010.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_contour_fit011.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_contour_fit012.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_contour_fit013.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_contour_fit014.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_contour_fit015.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_contour_fit016.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_contour_fit017.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_contour_fit018.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_contour_fit019.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_contour_fit020.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_contour_fit021.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_contour_fit022.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_contour_fit023.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_contour_fit024.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_contour_fit025.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_contour_fit026.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_contour_fit027.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_contour_fit028.svg" width="60%" style=" ">
</object>
</div>
{
<div class="figure">
<div id="regression-contour-fit-28-figure" class="figure-frame">
<object class="svgplot " data="../slides/diagrams/ml/regression_contour_fit028.svg" width="60%" style=" ">
</object>
</div>
</div>
</section>
<section id="stochastic-gradient-descent" class="slide level3">
<h3>Stochastic Gradient Descent</h3>
<ul>
<li>If <span class="math inline">\(\numData\)</span> is small, gradient descent is fine.</li>
<li>But sometimes (e.g. on the internet <span class="math inline">\(\numData\)</span> could be a billion.</li>
<li>Stochastic gradient descent is more similar to perceptron.</li>
<li>Look at gradient of one data point at a time rather than summing across <em>all</em> data points)</li>
<li>This gives a stochastic estimate of gradient.</li>
</ul>
</section>
<section id="stochastic-gradient-descent-1" class="slide level3">
<h3>Stochastic Gradient Descent</h3>
<ul>
<li><p>The real gradient with respect to <span class="math inline">\(m\)</span> is given by</p>
<p><span class="math display">\[\frac{\text{d}\errorFunction(m, c)}{\text{d} m} = -2\sum_{i=1}^\numData \inputScalar_i(\dataScalar_i -
m\inputScalar_i - c)\]</span></p>
<p>but it has <span class="math inline">\(\numData\)</span> terms in the sum. Substituting in the gradient we can see that the full update is of the form</p>
<p><span class="math display">\[m_\text{new} \leftarrow
m_\text{old} + 2\learnRate \left[\inputScalar_1 (\dataScalar_1 - m_\text{old}\inputScalar_1 - c_\text{old}) + (\inputScalar_2 (\dataScalar_2 -   m_\text{old}\inputScalar_2 - c_\text{old}) + \dots + (\inputScalar_n (\dataScalar_n - m_\text{old}\inputScalar_n - c_\text{old})\right]\]</span></p>
<p>This could be split up into lots of individual updates <span class="math display">\[m_1 \leftarrow m_\text{old} + 2\learnRate \left[\inputScalar_1 (\dataScalar_1 - m_\text{old}\inputScalar_1 -
c_\text{old})\right]\]</span> <span class="math display">\[m_2 \leftarrow m_1 + 2\learnRate \left[\inputScalar_2 (\dataScalar_2 -
m_\text{old}\inputScalar_2 - c_\text{old})\right]\]</span> <span class="math display">\[m_3 \leftarrow m_2 + 2\learnRate
\left[\dots\right]\]</span> <span class="math display">\[m_n \leftarrow m_{n-1} + 2\learnRate \left[\inputScalar_n (\dataScalar_n -
m_\text{old}\inputScalar_n - c_\text{old})\right]\]</span></p></li>
</ul>
<p>which would lead to the same final update.</p>
</section>
<section id="updating-c-and-m" class="slide level3">
<h3>Updating <span class="math inline">\(c\)</span> and <span class="math inline">\(m\)</span></h3>
<ul>
<li>In the sum we don’t <span class="math inline">\(m\)</span> and <span class="math inline">\(c\)</span> we use for computing the gradient term at each update.</li>
<li>In stochastic gradient descent we <em>do</em> change them.</li>
<li>This means it’s not quite the same as steepest desceint.</li>
<li>But we can present each data point in a random order, like we did for the perceptron.</li>
<li>This makes the algorithm suitable for large scale web use (recently this domain is know as ‘Big Data’) and algorithms like this are widely used by Google, Microsoft, Amazon, Twitter and Facebook.</li>
</ul>
</section>
<section id="stochastic-gradient-descent-2" class="slide level3">
<h3>Stochastic Gradient Descent</h3>
<ul>
<li>Or more accurate, since the data is normally presented in a random order we just can write <span class="math display">\[
m_\text{new} = m_\text{old} + 2\learnRate\left[\inputScalar_i (\dataScalar_i - m_\text{old}\inputScalar_i - c_\text{old})\right]
\]</span></li>
</ul>
</section>
<section id="sgd-for-linear-regression" class="slide level3">
<h3>SGD for Linear Regression</h3>
<p>Putting it all together in an algorithm, we can do stochastic gradient descent for our regression data.</p>
<script>
showDivs(0, 'regression_sgd_contour_fit');
</script>
<p><small></small> <input id="range-regression_sgd_contour_fit" type="range" min="0" max="58" value="0" onchange="setDivs('regression_sgd_contour_fit')" oninput="setDivs('regression_sgd_contour_fit')"> <button onclick="plusDivs(-1, 'regression_sgd_contour_fit')">❮</button> <button onclick="plusDivs(1, 'regression_sgd_contour_fit')">❯</button></p>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit000.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit001.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit002.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit003.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit004.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit005.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit006.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit007.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit008.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit009.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit010.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit011.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit012.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit013.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit014.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit015.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit016.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit017.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit018.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit019.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit020.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit021.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit022.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit023.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit024.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit025.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit026.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit027.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit028.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit029.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit030.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit031.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit032.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit033.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit034.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit035.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit036.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit037.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit038.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit039.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit040.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit041.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit042.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit043.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit044.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit045.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit046.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit047.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit048.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit049.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit050.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit051.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit052.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit053.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit054.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit055.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit056.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit057.svg" width="60%" style=" ">
</object>
</div>
<div class="regression_sgd_contour_fit" style="text-align:center;">
<object class="svgplot " data="../slides/diagrams/ml/regression_sgd_contour_fit058.svg" width="60%" style=" ">
</object>
</div>
</section>
<section id="reflection-on-linear-regression-and-supervised-learning" class="slide level3">
<h3>Reflection on Linear Regression and Supervised Learning</h3>
<p>Think about:</p>
<ol type="1">
<li><p>What effect does the learning rate have in the optimization? What’s the effect of making it too small, what’s the effect of making it too big? Do you get the same result for both stochastic and steepest gradient descent?</p></li>
<li><p>The stochastic gradient descent doesn’t help very much for such a small data set. It’s real advantage comes when there are many, you’ll see this in the lab.</p></li>
</ol>
</section>
<section id="log-likelihood-for-multivariate-regression" class="slide level3">
<h3>Log Likelihood for Multivariate Regression</h3>
<p>The likelihood of a single data point is</p>
<div class="fragment">
<p><span class="math display">\[p\left(\dataScalar_i|\inputScalar_i\right)=\frac{1}{\sqrt{2\pi\dataStd^2}}\exp\left(-\frac{\left(\dataScalar_i-\mappingVector^{\top}\inputVector_i\right)^{2}}{2\dataStd^2}\right).\]</span></p>
</div>
<div class="fragment">
<p>Leading to a log likelihood for the data set of</p>
</div>
<div class="fragment">
<p><span class="math display">\[L(\mappingVector,\dataStd^2)= -\frac{\numData}{2}\log \dataStd^2-\frac{\numData}{2}\log 2\pi -\frac{\sum_{i=1}^{\numData}\left(\dataScalar_i-\mappingVector^{\top}\inputVector_i\right)^{2}}{2\dataStd^2}.\]</span></p>
</div>
</section>
<section id="error-function-1" class="slide level3">
<h3>Error Function</h3>
<p>And a corresponding error function of <span class="math display">\[\errorFunction(\mappingVector,\dataStd^2)=\frac{\numData}{2}\log\dataStd^2 + \frac{\sum_{i=1}^{\numData}\left(\dataScalar_i-\mappingVector^{\top}\inputVector_i\right)^{2}}{2\dataStd^2}.\]</span></p>
</section>
<section id="expand-the-brackets" class="slide level3">
<h3>Expand the Brackets</h3>
<p><span class="math display">\[
\begin{align*}
  \errorFunction(\mappingVector,\dataStd^2)  = &amp;
\frac{\numData}{2}\log \dataStd^2 + \frac{1}{2\dataStd^2}\sum
_{i=1}^{\numData}\dataScalar_i^{2}-\frac{1}{\dataStd^2}\sum
_{i=1}^{\numData}\dataScalar_i\mappingVector^{\top}\inputVector_i\\&amp;+\frac{1}{2\dataStd^2}\sum
_{i=1}^{\numData}\mappingVector^{\top}\inputVector_i\inputVector_i^{\top}\mappingVector
+\text{const}.\\
    = &amp; \frac{\numData}{2}\log \dataStd^2 + \frac{1}{2\dataStd^2}\sum
_{i=1}^{\numData}\dataScalar_i^{2}-\frac{1}{\dataStd^2}
\mappingVector^\top\sum_{i=1}^{\numData}\inputVector_i\dataScalar_i\\&amp;+\frac{1}{2\dataStd^2}
\mappingVector^{\top}\left[\sum
_{i=1}^{\numData}\inputVector_i\inputVector_i^{\top}\right]\mappingVector +\text{const}.
\end{align*}
\]</span></p>
<!-- SECTION Multiple Input Solution with Linear Algebra -->
<!-- SECTION Design Matrix -->
<!-- SECTION Objective Optimisation -->
</section>
<section id="multivariate-derivatives" class="slide level3">
<h3>Multivariate Derivatives</h3>
<ul>
<li>We will need some multivariate calculus.</li>
<li>For now some simple multivariate differentiation: <span class="math display">\[\frac{\text{d}{\mathbf{a}^{\top}}{\mappingVector}}{\text{d}\mappingVector}=\mathbf{a}\]</span> and <span class="math display">\[\frac{\mappingVector^{\top}\mathbf{A}\mappingVector}{\text{d}\mappingVector}=\left(\mathbf{A}+\mathbf{A}^{\top}\right)\mappingVector\]</span> or if <span class="math inline">\(\mathbf{A}\)</span> is symmetric (<em>i.e.</em> <span class="math inline">\(\mathbf{A}=\mathbf{A}^{\top}\)</span>) <span class="math display">\[\frac{\text{d}\mappingVector^{\top}\mathbf{A}\mappingVector}{\text{d}\mappingVector}=2\mathbf{A}\mappingVector.\]</span></li>
</ul>
</section>
<section id="differentiate-the-objective" class="slide level3">
<h3>Differentiate the Objective</h3>
<p><span style="text-align:left">Differentiating with respect to the vector <span class="math inline">\(\mappingVector\)</span> we obtain</span> <span class="math display">\[
\frac{\partial L\left(\mappingVector,\dataStd^2 \right)}{\partial
\mappingVector}=\frac{1}{\dataStd^2} \sum _{i=1}^{\numData}\inputVector_i \dataScalar_i-\frac{1}{\dataStd^2}
\left[\sum _{i=1}^{\numData}\inputVector_i\inputVector_i^{\top}\right]\mappingVector
\]</span> Leading to <span class="math display">\[
\mappingVector^{*}=\left[\sum
_{i=1}^{\numData}\inputVector_i\inputVector_i^{\top}\right]^{-1}\sum
_{i=1}^{\numData}\inputVector_i\dataScalar_i,
\]</span></p>
</section>
<section id="differentiate-the-objective-1" class="slide level3">
<h3>Differentiate the Objective</h3>
<p>Rewrite in matrix notation: <span class="math display">\[
\sum_{i=1}^{\numData}\inputVector_i\inputVector_i^\top = \inputMatrix^\top \inputMatrix
\]</span> <span class="math display">\[
\sum_{i=1}^{\numData}\inputVector_i\dataScalar_i = \inputMatrix^\top \dataVector
\]</span></p>
<!-- SECTION Update Equation for Global Optimum -->
</section>
<section id="update-equations-2" class="slide level3">
<h3>Update Equations</h3>
<ul>
<li>Update for <span class="math inline">\(\mappingVector^{*}\)</span>. <span class="math display">\[\mappingVector^{*} = \left(\inputMatrix^\top \inputMatrix\right)^{-1} \inputMatrix^\top \dataVector\]</span></li>
<li>The equation for <span class="math inline">\(\left.\dataStd^2\right.^{*}\)</span> may also be found <span class="math display">\[\left.\dataStd^2\right.^{{*}}=\frac{\sum_{i=1}^{\numData}\left(\dataScalar_i-\left.\mappingVector^{*}\right.^{\top}\inputVector_i\right)^{2}}{\numData}.\]</span></li>
</ul>
</section>
<section id="solving-the-multivariate-system" class="slide level3">
<h3>Solving the Multivariate System</h3>
<div class="figure">
<div id="mlai-3-maximum-likelihood-figure" class="figure-frame">
<iframe width="800" height="600" src="https://www.youtube.com/embed/78YNphT90-k?start=" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen>
</iframe>
</div>
</div>
<p>}</p>
</section>
<section id="reading-1" class="slide level3">
<h3>Reading</h3>
<ul>
<li>Section 1.3 of <span class="citation" data-cites="Rogers:book11">Rogers and Girolami (2011)</span> for Matrix &amp; Vector Review.</li>
</ul>
</section>
<section id="thanks" class="slide level3">
<h3>Thanks!</h3>
<ul>
<li>twitter: <a href="https://twitter.com/lawrennd">@lawrennd</a></li>
<li>podcast: <a href="http://thetalkingmachines.com">The Talking Machines</a></li>
<li>newspaper: <a href="http://www.theguardian.com/profile/neil-lawrence">Guardian Profile Page</a></li>
<li><p>Blog posts:</p>
<p><a href="http://inverseprobability.com/2017/07/17/what-is-machine-learning">What is Machine Learning?</a></p></li>
</ul>
</section>
<section id="references" class="slide level3 unnumbered">
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-Bishop:book06">
<p>Bishop, C.M., 2006. Pattern recognition and machine learning. springer.</p>
</div>
<div id="ref-Rogers:book11">
<p>Rogers, S., Girolami, M., 2011. A first course in machine learning. CRC Press.</p>
</div>
<div id="ref-Wasserman:all03">
<p>Wasserman, L.A., 2003. All of statistics. springer, New York.</p>
</div>
</div>
</section>
    </div>
  </div>

  <script src="reveal.js/lib/js/head.min.js"></script>
  <script src="reveal.js/js/reveal.js"></script>

  <script>

      // Full list of configuration options available at:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        // Push each slide change to the browser history
        history: true,
        // Transition style
        transition: 'None', // none/fade/slide/convex/concave/zoom
        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // Optional reveal.js plugins
        dependencies: [
          { src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
          { src: 'reveal.js/plugin/zoom-js/zoom.js', async: true },
          { src: 'reveal.js/plugin/math/math.js', async: true },
          { src: 'reveal.js/plugin/notes/notes.js', async: true }
        ]
      });
    </script>
    </body>
</html>
